<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=9; IE=8; IE=7; IE=EDGE">
    <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7"/>
    <title>畅购商城，欢迎登录</title>
    <link rel="icon" href="/img/favicon.ico">

    <link rel="stylesheet" type="text/css" href="/css/all.css"/>
    <link rel="stylesheet" type="text/css" href="/css/pages-login.css"/>
</head>

<body>
<!-- 头部栏位 -->
<!--页面顶部-->
<div id="nav-bottom">
    <!--顶部-->
    <div class="nav-top">
        <div class="top">
            <div class="py-container">
                <div class="shortcut">
                    <ul class="fl">
                        <li class="f-item">欢迎您！</li>
                        <li class="f-item">请<a href="login.html" target="_blank">登录</a>　<span><a href="register.html"
                                                                                                 target="_blank">免费注册</a></span>
                        </li>
                    </ul>
                    <div class="fr typelist">
                        <ul class="types">
                            <li class="f-item"><span>我的订单</span></li>

                            <li class="f-item"><span><a href="cart.html" target="_blank">我的购物车</a></span></li>
                            <li class="f-item"><span><a href="home.html" target="_blank">我的畅购</a></span></li>
                            <li class="f-item"><span>会员</span></li>
                            <li class="f-item"><span>企业采购</span></li>
                            <li class="f-item"><span>关注我们</span></li>
                            <li class="f-item"><span><a href="cooperation.html" target="_blank">合作招商</a></span></li>
                            <li class="f-item"><span><a href="shoplogin.html" target="_blank">商家后台</a></span></li>
                            <li class="f-item"><span>网站导航</li>
                        </ul>
                    </div>

                </div>
            </div>
        </div>

        <!--头部-->
        <div class="header">
            <div class="py-container">
                <div class="yui3-g Logo">
                    <div class="yui3-u Left logoArea">
                        <a class="logo-bd" title="青橙" href="index.html" target="_blank"></a>
                    </div>
                    <div class="yui3-u Rit searchArea">
                        <div class="search">
                            <form action="" class="sui-form form-inline">
                                <!--searchAutoComplete-->
                                <div class="input-append">
                                    <input type="text" id="autocomplete" class="input-error input-xxlarge"/>
                                    <button class="sui-btn btn-xlarge btn-danger" type="button">搜索</button>
                                </div>
                            </form>
                        </div>
                    </div>

                </div>

            </div>
        </div>
    </div>
</div>

<div id="app" class="login-box">

    <!--loginArea-->
    <div class="loginArea">
        <div class="py-container login">
            <div class="loginform">
                <ul class="sui-nav nav-tabs tab-wraped">
                    <li id="tabSuiForm" class="active" onclick="switchSuiForm()">
                        <a href="javascript:void(0)" data-toggle="tab">
                            <h3>账户登录</h3>
                        </a>
                    </li>
                </ul>
                <div class="tab-content tab-wraped">
                    <div id="profile" class="tab-pane active">
                          <div class="sui-form">
                            <div class="input-prepend"><span class="add-on loginname"></span>
                                <input id="inputName"  v-model="username" name="username" type="text"
                                       placeholder="邮箱/用户名/手机号"
                                       class="span2 input-xfat">
                            </div>
                            <div class="input-prepend"><span class="add-on loginpwd"></span>
                                <input id="inputPassword" v-model="password" name="password" type="password"
                                       placeholder="请输入密码"
                                       class="span2 input-xfat">
                            </div>
                            <div class="setting">
                                <label class="checkbox inline">
                                    <input name="m1" type="checkbox" value="2" checked="">
                                    自动登录
                                </label>
                                <span class="forget">忘记密码？</span>
                            </div>
                            <div class="logined">
                                <div style="text-align: center;color: #ff0000;">{{msg}}</div>
                                <button @click="login()" class="sui-btn btn-block btn-xlarge btn-danger">
                                    登&nbsp;&nbsp;录
                                </button>
                            </div>
                          </div>

                        <div class="otherlogin">
                            <div class="types">
                                <ul>
                                    <li><img src="/img/qq.png" width="35px" height="35px"/></li>
                                    <li><img src="/img/sina.png"/></li>
                                    <li><img src="/img/ali.png"/></li>
                                    <li><img src="/img/weixin.png"/></li>
                                </ul>
                            </div>
                            <span class="register"><a href="register.html" target="_blank">立即注册</a></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--foot-->
    <div class="py-container copyright">
        <ul>
            <li>关于我们</li>
            <li>联系我们</li>
            <li>联系客服</li>
            <li>商家入驻</li>
            <li>营销中心</li>
            <li>手机品优购</li>
            <li>销售联盟</li>
            <li>品优购社区</li>
        </ul>
        <div class="address">地址：北京市昌平区建材城西路金燕龙办公楼一层 邮编：100096 电话：400-618-4000 传真：010-82935100</div>
        <div class="beian">京ICP备08001421号京公网安备110108007702
        </div>
    </div>
</div>

<script type="text/javascript">
    function switchOtherLogin() {
        document.getElementById('index').className = "tab-pane active";
        document.getElementById('profile').className = "tab-pane";
        document.getElementById('tabSuiForm').className = "";
        document.getElementById('tabOtherLogin').className = "active";
    }
</script>

<script src="/js/vue.js"></script>
<script src="/js/axios.js"></script>

<script th:inline="javascript">
    var app = new Vue({
        el: "#app",
        data: {
            msg: '', // 提示信息
            username: '', // 登录名字
            password: '', // 登录密码
            from: [[${from}]]
        },
        methods: {
            login: function () {
                app.msg = '正在登录...';
                axios.post('/user/login?username=' + app.username + '&password=' + this.password).then(
                    function (response) {
                        if (response.data.flag) {

                            // 这里获取到的是 localhost:8001/api/cart/list 啊。
                            alert(app.from);
                           //登录成功
                            app.msg = '登录成功，3s后跳转';
                            if(app.from===''){
                                // 登录成功则跳转至商城首页
                                app.from='http://localhost:18086/search/list';
                                alert(app.from);
                            }
                           setTimeout(function (){
                            location.href=app.from;},3000);
                    }
                        else {
                            app.msg = response.data.message;
                        }
                    })
            }
        }
    })
</script>
</body>
</html>